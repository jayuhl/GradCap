<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="./style.css" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GradCap
    </title>
    <script src="GradCapClasses.js"></script>
</head>
<body>
    <div id="page-title">
        GradCap Graduation Requirement Tracker
    </div>
    <div class="main_container">
        <div class="counselor_column">
            <div class="counselor_list_container">
                <p class="title_area">Counselors</p>
                <ul id="counselor_list_item_container">
                    <li id="1000" class='selected_counselor'>All Students</li>
                    <!-- <li>Counselor 2</li>
                    <li>Counselor 3</li>
                    <li>Counselor 4</li>
                    <li>Counselor 5</li>
                    <li>Counselor 6</li>
                    <li>Counselor 7</li>
                    <li>Counselor 8</li>
                    <li>Counselor 9</li>
                    <li>Counselor 10</li>
                    <li>Counselor 11</li>
                    <li>Counselor 12</li>
                    <li>Counselor 13</li>
                    <li>Counselor 14</li>
                    <li>Counselor 15</li>
                    <li>Counselor 16</li>
                    <li>Counselor 17</li>
                    <li>Counselor 18</li>
                    <li>Counselor 19</li>
                    <li>Counselor 20</li> -->
                </ul>
            </div>
            <div class="counselor_totals_container">
                <p class="title_area" id="totals_title_school">School Totals</p>
                <ul id="counselor_totals_item_container">
                    <li>Total Students = <span id="total-students">0</span></li>
                    <li>Freshmen = <span id="total-freshmen">0</span></li>
                    <li>Sophomores = <span id="total-sophomores">0</span></li>
                    <li>Juniors = <span id="total-juniors">0</span></li>
                    <li>Seniors = <span id="total-seniors">0</span></li>
                    <li>Warnings = <span id="total-warnings">0</span></li>
                    <li>Overrides = <span id="total-overrides">0</span></li>
                </ul>
            </div>
        </div>
        <div class="student_column">
            <div class="student_list_container">
                <p class="title_area">Students</p>
                <ul id="student_list_item_container">
                    <li class='selected_student'>Student 1</li>
                    <!-- <li>Student 2</li>
                    <li>Student 3</li>
                    <li>Student 4</li>
                    <li>Student 5</li>
                    <li>Student 6</li>
                    <li>Student 7</li>
                    <li>Student 8</li>
                    <li>Student 9</li>
                    <li>Student 10</li>
                    <li>Student 11</li>
                    <li>Student 12</li>
                    <li>Student 13</li>
                    <li>Student 14</li>
                    <li>Student 15</li>
                    <li>Student 16</li>
                    <li>Student 17</li>
                    <li>Student 18</li>
                    <li>Student 19</li>
                    <li>Student 20</li> -->
                </ul>
            </div>
            <div class="student_radios_container">
                <div id="student_sort_options_container">
                    <p class="title_area">Sort Options</p>
                    <label for="alphabetical"><input type="radio" id="alphabetical" name="sort_options_group" value="alphabetical" checked onclick="setSortValue('alpha')"><span>Alphabetically</span></label><br>
                    <label for="grad_reqs"><input type="radio" id="grad_reqs" name="sort_options_group" value="grad_reqs" onclick="setSortValue('gradreqs')"><span>By Grad Reqs</span></label><br>
                    <label for="credit_total"><input type="radio" id="credit_total" name="sort_options_group" value="credit_total" onclick="setSortValue('credits')"><span>By Credits</span></label>
                </div>
                <div id="student_filter_options_container">
                    <p class="title_area">Filter Options:</p>
                    <label for="all_students"><input type="radio" id="all_students" name="filter_options_group" value="all_students" checked onclick="setGradeLevelFilterValue(0)"><span>All Years</span></label><br>
                    <label for="freshmen"><input type="radio" id="freshmen" name="filter_options_group" value="freshmen" onclick="setGradeLevelFilterValue(9)"><span>Freshmen</span></label><br>
                    <label for="sophomores"><input type="radio" id="sophomores" name="filter_options_group" value="sophomores" onclick="setGradeLevelFilterValue(10)"><span>Sophomores</span></label><br>
                    <label for="juniors"><input type="radio" id="juniors" name="filter_options_group" value="juniors"onclick="setGradeLevelFilterValue(11)"><span>Juniors</span></label><br>
                    <label for="seniors"><input type="radio" id="seniors" name="filter_options_group" value="seniors" onclick="setGradeLevelFilterValue(12)"><span>Seniors</span></label>
                </div>
            </div>
        </div>


        <div class="student_info_general_container">
            <div class="student_top_container">
                <p class="title_area">Student Data</p>
                <div class="student-info-grid">
                    <div class="grid-item">Name:</div>

                    <div class="studentdata-dropdown-wrapper">
                        <select id="student-names-dropdown" class="studentdata-dropdown-options">
                            <option value="s1">Spongebob Squarepants</option>
                            <option value="s2">Sandy Cheeks</option>
                            <option value="s3">Squidward Tentacles</option>
                            <option value="s4">Mr. Krabs</option>
                            <option value="s5">Plankton</option>
                            <option value="s6">Gary Snail</option>
                        </select>
                        <!-- <span class="custom-arrow"></span> -->
                    </div>        


                    <div class="grid-item">Grade Level: </div>
                    <div id="student-grade-level" class="grid-item-data">10</div>
                    <div class="grid-item">ID:</div>
                    <div id="student-id" class="grid-item-data">810432</div>
                    <div class="grid-item">Counselor:</div>

                    <div class="studentdata-dropdown-wrapper">
                        <select id="counselor-names-dropdown" class="studentdata-dropdown-options">
                            <option value="s1">Steve Casamento</option>
                            <option value="s2">Valerie DelRusso</option>
                            <option value="s3">Marin Donnelly</option>
                            <option value="s4">Jenna Howard</option>
                            <option value="s5">Cristina Schneider</option>
                            <option value="s6">All Students</option>
                        </select>
                        <!-- <span class="custom-arrow"></span> -->
                    </div>


                    <div class="grid-item">Status:</div>
                    <div class="grid-item-data" id="status-field">Requirements are...</div>
                </div>
            </div>
            
            <!-- an attempt to use a spinner -->
            <div class="dropdown-wrapper">
                <select id="dropdown-options">
                    <option value="Summary">Graduation Requirement Summary</option>
                    <option value="Transcript">Full Transcript</option>
                    <option value="Freshman">Freshman Year</option>
                    <option value="Sophomore">Sophomore Year</option>
                    <option value="Junior">Junior Year</option>
                    <option value="Senior">Senior Year</option>
                </select>
                <!-- <span class="custom-arrow"></span> -->
            </div>
            <!-- Data Panels -->
            <!-- <div class="student_course_container"> -->
            <div class="table-outer-wrapper">
                <div id="summary-content" class="content-pane">
                    <table id="gradreq_table">
                        <!-- <caption>
                            Graduation Requirement Summary
                        </caption> -->
                        <thead>
                            <tr>
                                <th onclick='sortTable(0,"gradreq_table", 1, false)' scope="col">Category</th>
                                <th onclick='sortTable(1,"gradreq_table", 1, false)' scope="col">Code</th>
                                <th onclick='sortTable(2,"gradreq_table", 1, true)' scope="col">Earned</th>
                                <th onclick='sortTable(3,"gradreq_table", 1, true)' scope="col">Required</th>
                                <th onclick='sortTable(4,"gradreq_table", 1, true)' scope="col">Needed</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr onclick="highlight_gradReq(this);">
                                <td class="table-item-left-justify">English</td>
                                <td>ENG</td>
                                <td>2.0</td>
                                <td>4.0</td>
                                <td>2.0</td>
                            </tr>
                            <tr onclick="highlight_gradReq(this);">
                                <td class="table-item-left-justify">Math</td>
                                <td>MATH</td>
                                <td>2.0</td>
                                <td>3.0</td>
                                <td>1.0</td>
                            </tr>
                            <tr onclick="highlight_gradReq(this);">
                                <td class="table-item-left-justify">History</td>
                                <td>HIST</td>
                                <td>2.0</td>
                                <td>3.0</td>
                                <td>1.0</td>
                            </tr>
                            <tr onclick="highlight_gradReq(this);">
                                <td class="table-item-left-justify">Science</td>
                                <td>SCI</td>
                                <td>1.0</td>
                                <td>3.0</td>
                                <td>2.0</td>
                            </tr>
                            <tr onclick="highlight_gradReq(this);">
                                <td class="table-item-left-justify">Language</td>
                                <td>WL</td>
                                <td>1.0</td>
                                <td>2.0</td>
                                <td>1.0</td>
                            </tr>
                            <tr onclick="highlight_gradReq(this);">
                                <td class="table-item-left-justify">Visual or Performing Art</td>
                                <td>VPA</td>
                                <td>0.0</td>
                                <td>1.0</td>
                                <td>1.0</td>
                            </tr>
                            <tr onclick="highlight_gradReq(this);">
                                <td class="table-item-left-justify">Practical Art</td>
                                <td>PA</td>
                                <td>1.0</td>
                                <td>2.0</td>
                                <td>1.0</td>
                            </tr>
                            <tr onclick="highlight_gradReq(this);">
                                <td class="table-item-left-justify">Personal Financial Literacy</td>
                                <td>PFL</td>
                                <td>0.0</td>
                                <td>0.5</td>
                                <td>0.5</td>
                            </tr>
                    </tbody>
                    <!-- <tfoot>
                        <tr>
                            <th scope="row" colspan="4">Total Needed</th>
                            <td>9.5</td>
                        </tr>
                    </tfoot> -->
                </table>
                
            </div>


            <div id="transcript-content" class="content-pane">
                <!-- Historical Course Data -->
                <!-- <button onclick="getSelectedRow()">Snatch Data</button> -->
                <div id="transcript-placeholder-text"></div>
                    <table id="transcript-course_table">
                        <thead>
                            <tr>
                                <th onclick='sortTable(0,"transcript-course_table", 1, true)'>Year</th>
                                <th onclick='sortTable(1,"transcript-course_table", 1, false)'>Course Name</th>
                                <th onclick='sortTable(2,"transcript-course_table", 1, false)'>Code</th>
                                <th onclick='sortTable(3,"transcript-course_table", 1, false)'>Req Met</th>
                                <th onclick='sortTable(4,"transcript-course_table", 1, false)'>Or</th>
                                <th onclick='sortTable(5,"transcript-course_table", 1, true)'>Points</th>
                                <th onclick='sortTable(6,"transcript-course_table", 1, true)'>Credits</th>
                                <th onclick='sortTable(7,"transcript-course_table", 1, true)'>Avg</th>
                                <th onclick='sortTable(8,"transcript-course_table", 1, false)'>Teacher</th>
                                <th onclick='sortTable(9,"transcript-course_table", 1, true)'>Sect</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr onclick="highlight_course(this);">
                                <td>9</td>
                                <td class="table-item-left-justify">Honors Comp Sci</td>
                                <td>MA6404</td>
                                <td>PA</td>
                                <td></td>
                                <td>1.0</td>
                                <td>5.0</td>
                                <td>93.0</td>
                                <td class="table-item-left-justify">Uhl</td>
                                <td>2</td>
                            </tr>
                            <tr onclick="highlight_course(this);">
                                <td>10</td>
                                <td class="table-item-left-justify">AP Comp Sci</td>
                                <td>MA6504</td>
                                <td>PA</td>
                                <td></td>
                                <td>1.0</td>
                                <td>5.0</td>
                                <td>93.0</td>
                                <td class="table-item-left-justify">Uhl</td>
                                <td>1</td>
                            </tr>
                            <tr onclick="highlight_course(this);">
                                <td>11</td>
                                <td class="table-item-left-justify">Advanced Topics in Comp Sci</td>
                                <td>MA6704</td>
                                <td>PA</td>
                                <td></td>
                                <td>1.0</td>
                                <td>5.0</td>
                                <td>93.0</td>
                                <td class="table-item-left-justify">Uhl</td>
                                <td>1</td>
                            </tr>
                            <tr onclick="highlight_course(this);">
                                <td>12</td>
                                <td class="table-item-left-justify">More Comp Sci</td>
                                <td>MA6804</td>
                                <td>PA</td>
                                <td></td>
                                <td>1.0</td>
                                <td>5.0</td>
                                <td>95.0</td>
                                <td class="table-item-left-justify">Uhl</td>
                                <td>1</td>
                            </tr>
                            <tr onclick="highlight_course(this);">
                                <td>12</td>
                                <td class="table-item-left-justify">More Comp Sci</td>
                                <td>MA6804</td>
                                <td>PA</td>
                                <td></td>
                                <td>1.0</td>
                                <td>5.0</td>
                                <td>95.0</td>
                                <td class="table-item-left-justify">Uhl</td>
                                <td>1</td>
                            </tr>
                            <tr onclick="highlight_course(this);">
                                <td>13</td>
                                <td class="table-item-left-justify">More Comp Sci</td>
                                <td>MA6804</td>
                                <td>PA</td>
                                <td></td>
                                <td>1.0</td>
                                <td>5.0</td>
                                <td>95.0</td>
                                <td class="table-item-left-justify">Uhl</td>
                                <td>1</td>
                            </tr>
                        </tbody>
                    </table>
            </div>


                
                <div id="freshman-content" class="content-pane">
                    <div id="freshman-placeholder-text" style="display: none;">No Freshman Year Courses Found</div>
                    <table id="freshman-course_table">
                        <thead>
                            <tr>
                                <th>Year</th>
                                <th>Course Name</th>
                                <th>Code</th>
                                <th>Req Met</th>
                                <th>Or</th>
                                <th>Points</th>
                                <th>Credits</th>
                                <th>Avg</th>
                                <th>Teacher</th>
                                <th>Sect</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr onclick="highlight_course(this);">
                                <td>9</td>
                                <td class="table-item-left-justify">Honors Comp Sci</td>
                                <td>MA6404</td>
                                <td>PA</td>
                                <td></td>
                                <td>1.0</td>
                                <td>5.0</td>
                                <td>93.0</td>
                                <td class="table-item-left-justify">Uhl</td>
                                <td>2</td>
                            </tr>
                            <tr onclick="highlight_course(this);">
                                <td>10</td>
                                <td class="table-item-left-justify">AP Comp Sci</td>
                                <td>MA6504</td>
                                <td>PA</td>
                                <td></td>
                                <td>1.0</td>
                                <td>5.0</td>
                                <td>93.0</td>
                                <td class="table-item-left-justify">Uhl</td>
                                <td>1</td>
                            </tr>
                            <tr onclick="highlight_course(this);">
                                <td>11</td>
                                <td class="table-item-left-justify">Advanced Topics in Comp Sci</td>
                                <td>MA6704</td>
                                <td>PA</td>
                                <td></td>
                                <td>1.0</td>
                                <td>5.0</td>
                                <td>93.0</td>
                                <td class="table-item-left-justify">Uhl</td>
                                <td>1</td>
                            </tr>
                            <tr onclick="highlight_course(this);">
                                <td>12</td>
                                <td class="table-item-left-justify">More Comp Sci</td>
                                <td>MA6804</td>
                                <td>PA</td>
                                <td></td>
                                <td>1.0</td>
                                <td>5.0</td>
                                <td>95.0</td>
                                <td class="table-item-left-justify">Uhl</td>
                                <td>1</td>
                            </tr>
                            <tr onclick="highlight_course(this);">
                                <td>12</td>
                                <td class="table-item-left-justify">More Comp Sci</td>
                                <td>MA6804</td>
                                <td>PA</td>
                                <td></td>
                                <td>1.0</td>
                                <td>5.0</td>
                                <td>95.0</td>
                                <td class="table-item-left-justify">Uhl</td>
                                <td>1</td>
                            </tr>
                            <tr onclick="highlight_course(this);">
                                <td>14</td>
                                <td class="table-item-left-justify">More Comp Sci</td>
                                <td>MA6804</td>
                                <td>PA</td>
                                <td></td>
                                <td>1.0</td>
                                <td>5.0</td>
                                <td>95.0</td>
                                <td class="table-item-left-justify">Uhl</td>
                                <td>1</td>
                            </tr>
                        </tbody>
                    </table>
                    </div>


                    <div id="sophomore-content" class="content-pane">
                        <div id="sophomore-placeholder-text">No Sophomore Year Courses Found</div>
                        <table id="sophomore-course_table">
                        </table>
                    </div>

                    <div id="junior-content" class="content-pane">
                        <div id="junior-placeholder-text">No Junior Year Courses Found</div>
                        <table id="junior-course_table">
                        </table>
                    </div>

                    <div id="senior-content" class="content-pane">
                        <div id="senior-placeholder-text">No Senior Year Courses Found</div>
                        <table id="senior-course_table">
                        </table>
                    </div>

                 
            </div> 

            <!-- To read in csv files as JSON -->
            <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js">
            </script>

            <div id="testingstuff-container">
                <!-- <button id="csv-counselor-button">Populate Counselor Data</button> -->
                <!-- <button id="csv-requirement-button">Populate Grad Reqmt Data</button> -->
                <!-- <div> -->
                    <p>Select local CSV File with Student Data:</p>
                    <input id="csv" type="file" accept=".csv" onChange="fileNameChange()">
                    <button id="csv-student-button" style="visibility:hidden">Populate Student Data</button>
                <!-- </div> -->
                <!-- <div> -->
                    <!-- <pre id="out">
                        <p>File contents will appear here</p>
                    </pre> -->
                <!-- </div> -->
            </div>


        </div>
        </div>
        </body>
        

        <style>
            #testingstuff-container {
                padding: 0px 20px;
            }
        </style>

<script>

//Student Reader - Populate Student data from csv
const uploadConfirm = document.getElementById('csv-student-button').addEventListener('click', () => {
    Papa.parse(document.getElementById('csv').files[0],
    {
        download: true,
        header: true,
        skipEmptyLines: true,
        complete: function(results) {
            // const myObj = JSON.parse(results.data[2]);
            // var keyss = Object.keys(results.data[0]);
            
            // console.log(keyss);
            // console.log("NAME: " + results.data[0]['Last Name']);

            populateRequirementsForPVRHSD();
            populateCounselorListForPH();
            populateCounselorLI();
            setFirstCounselorAsCurrent(); //The first counselor is "All Students"

            populateStudentArrayFromJSON(results);

            //Adjust req codes if needed
            for(var i=0; i < studentList.length; i++)
                assignOptimalMultiCodeRequirementCourses(studentList[i], false);

            populateStudentLI();
            setFirstStudentAsCurrent();

            updateTotalsArea();
            
            //   console.log(results.data[0]);
            //   console.log(studentList[0]);
            document.getElementById("csv-student-button").style.visibility = "hidden";
        }
    });
});

function fileNameChange() {
    // console.log('file was selected');
    document.getElementById("csv-student-button").style.visibility = "visible";
}

//USE THIS WHEN LOADING COUNSELOR DATA FROM A LOCAL CSV
// Counselor Reader - Populate Counselor data from csv
// const uploadCounselorConfirm = document.getElementById('csv-counselor-button').addEventListener('click', () => {
//     Papa.parse(document.getElementById('csv').files[0],
//     {
//         download: true,
//         header: true,
//         skipEmptyLines: true,
//         complete: function(results) {
//             //     var ul = document.getElementById("counselor_list_item_container");
//             //     for (var i = 0; i < results.data.length; i++)
//             //     {
//                 //         var li = document.createElement("li");
//                 //         li.className = "counselor-container";
                
//                 //         li.innerHTML = results.data[i]['Last Name'];
                
//                 //         ul.appendChild(li);
//                 //   }
//                 populateCounselorArrayFromJSON(results);
//                 populateCounselorLI();
//                 console.log(counselorList[0].getLastName());
//         }
//     });
// });

//USE THIS WHEN LOADING GRAD REQUIREMENT DATA FROM A LOCAL CSV
// Grad Requirement Reader - Populate graduation requirement data from csv
// const uploadRequirementConfirm = document.getElementById('csv-requirement-button').addEventListener('click', () => {
//     Papa.parse(document.getElementById('csv').files[0],
//     {
//         download: true,
//         header: true,
//         skipEmptyLines: true,
//         complete: function(results) {
//         //     var ul = document.getElementById("counselor_list_item_container");
//         //     for (var i = 0; i < results.data.length; i++)
//         //     {
//         //         var li = document.createElement("li");
//         //         li.className = "counselor-container";

//         //         li.innerHTML = results.data[i]['Last Name'];

//         //         ul.appendChild(li);
//         //   }
//           populateRequirementsFromJSON(results);
//           console.log(graduationRequirementList[0].getRequirementName());
//         }
//     });
// });

//Populate student list - currently for all students (not a subset)
function populateStudentLI() {
    var ul = document.getElementById("student_list_item_container");
    //Remove current list items to make way for updated ones
    while( ul.firstChild ){
        ul.removeChild( ul.firstChild );
    }
    //Populate the list items in the HTML
    for (var i = 0; i < currentStudentList.length; i++)
    {
        if(currentStudentList[i].getGradeLevel() == 8)
            console.log("FOUND: " + currentStudentList[i].getNameLastFirst());
        var li = document.createElement("li");  
        li.className = "student-container";

        li.innerHTML = currentStudentList[i].getNameLastFirst();
        li.id = currentStudentList[i].id;
        
        if(currentStudentList[i].isApprovedByOverride)
            li.classList.add("gradrequirement-override");
        else if(!currentStudentList[i].hasMetAllGradRequirements())
            li.classList.add("gradrequirement-warning");
        else if(!currentStudentList[i].hasMetCreditRequirement())
            li.classList.add("creditsLow-warning");
        else
            li.classList.add("gradrequirement-met");

        // console.log(currentStudentList[i] + " " + currentStudentList[i].hasMetAllGradRequirements())
        ul.appendChild(li);
    }
}

//Populate counselor list for all counselors
function populateCounselorLI() {
    var ul = document.getElementById("counselor_list_item_container");
    //Currently not removing the first item... "All Students"... now I am
    ul.removeChild(ul.getElementsByTagName('li')[0]);
    for (var i = 0; i < counselorList.length; i++)
    {
        var li = document.createElement("li");
        li.className = "counselor-container";

        if(counselorList[i].getLastName() === 'All Students')
            li.innerHTML = 'All Students';
        else if(counselorList[i].getLastName() === 'Unassigned')
            li.innerHTML = 'Unassigned';
        else
            li.innerHTML = counselorList[i].getNameLastFirst();

        li.id = counselorList[i].id;

        ul.appendChild(li);
    }
}


//THE MAIN UPDATING FUNCTION FOR WHEN A NEW STUDENT IS SELECTED OR DEFAULTED
//This should be called each time a student is changed
function setCurrentStudentDataFields() {
    console.log("Updating student info for: " + currentStudent.getNameLastFirst());
    if(currentStudent.completedCourses.length > 0) {
        // console.log(currentStudent.completedCourses[0]);
        createSummaryTable(currentStudent);
        createYearTable(0); //transcript (history)
        createYearTable(9);
        createYearTable(10);
        createYearTable(11);
        createYearTable(12);
    }

    //Set selected student name
    var studentNameContainer = document.getElementById('student-names-dropdown');
    studentNameContainer.options[0].remove(); //so the list doen't buid up
    var studentOptionElement = document.createElement('option');
    studentOptionElement.value = 's0';
    // option.onclick=function(){sortTable(0);}
    var studentOptionText = document.createTextNode(currentStudent.getNameLastFirst());
    studentOptionElement.appendChild(studentOptionText);
    studentNameContainer.insertBefore(studentOptionElement, studentNameContainer.firstChild);
    studentNameContainer.selectedIndex = 0;

    //Set selected student counselor name
    var counselorNameContainer = document.getElementById('counselor-names-dropdown');
    counselorNameContainer.options[0].remove(); //so the list doen't buid up
    var counselorOptionElement = document.createElement('option');
    counselorOptionElement.value = 's0';
    // option.onclick=function(){sortTable(0);}
    var counselorOptionText = document.createTextNode(currentStudent.getCounselorName());
    counselorOptionElement.appendChild(counselorOptionText);
    counselorNameContainer.insertBefore(counselorOptionElement, counselorNameContainer.firstChild);
    counselorNameContainer.selectedIndex = 0;

    //Set selected student grade level
    var gradeLevelContainer = document.getElementById('student-grade-level');
    gradeLevelContainer.innerHTML = currentStudent.getGradeLevel();
    
    //Set selected student grade level name
    var idContainer = document.getElementById('student-id');
    idContainer.innerHTML = currentStudent.getId();
    
    //Set selected student status
    var statusContainer = document.getElementById('status-field');
    statusContainer.innerHTML = '';
    var checkbox = document.createElement('input');
    checkbox.type = "checkbox";
    checkbox.name = "override-checkbox";
    checkbox.value = "value";
    checkbox.id = "checkbox-override";
    if(currentStudent.isApprovedByOverride)
        checkbox.checked = true;

    checkbox.addEventListener('change', function() {
        if (this.checked) {
            currentStudent.isApprovedByOverride = true;
            var selected= document.querySelector('li.selected_student');
            var selectedIndex = [].slice.call(selected.parentNode.children).indexOf(selected);
            populateStudentLI();
            var studentUL = document.getElementById('student_list_item_container');
            var currentStudentLI = studentUL.getElementsByTagName('li')[selectedIndex];
            currentStudentLI.classList.add('selected_student');
            console.log("Checkbox is checked..");
        } else {
            currentStudent.isApprovedByOverride = false;
            var selected= document.querySelector('li.selected_student');
            var selectedIndex = [].slice.call(selected.parentNode.children).indexOf(selected);
            populateStudentLI();
            var studentUL = document.getElementById('student_list_item_container');
            var currentStudentLI = studentUL.getElementsByTagName('li')[selectedIndex];
            currentStudentLI.classList.add('selected_student');
            console.log("Checkbox is not checked..");
        }
    });

    var label = document.createElement('label');
    label.htmlFor = "id";
    label.appendChild(document.createTextNode('Override Approval of Graduation Requirements'));

    statusContainer.appendChild(checkbox);
    statusContainer.appendChild(label);
}


//For when there are no students to display
function clearStudentDataFields() {
    console.log("Clearing student data.");
    clearSummaryTable();
    clearYearTable(0);

    //Set selected student name
    var studentNameContainer = document.getElementById('student-names-dropdown');
    studentNameContainer.options[0].remove(); //so the list doen't buid up
    var studentOptionElement = document.createElement('option');
    studentOptionElement.value = 's0';
    // option.onclick=function(){sortTable(0);}
    var studentOptionText = document.createTextNode('');
    studentOptionElement.appendChild(studentOptionText);
    studentNameContainer.insertBefore(studentOptionElement, studentNameContainer.firstChild);
    studentNameContainer.selectedIndex = 0;

    //Set selected student counselor name
    var counselorNameContainer = document.getElementById('counselor-names-dropdown');
    counselorNameContainer.options[0].remove(); //so the list doen't buid up
    var counselorOptionElement = document.createElement('option');
    counselorOptionElement.value = 's0';
    // option.onclick=function(){sortTable(0);}
    var counselorName = currentCounselor.getNameLastFirst();
    if(currentCounselor.getLastName() === 'Unassigned')
        counselorName = 'Unassigned';
    var counselorOptionText = document.createTextNode(counselorName);
    counselorOptionElement.appendChild(counselorOptionText);
    counselorNameContainer.insertBefore(counselorOptionElement, counselorNameContainer.firstChild);
    counselorNameContainer.selectedIndex = 0;

    //Set selected student grade level
    var gradeLevelContainer = document.getElementById('student-grade-level');
    gradeLevelContainer.innerHTML = '';
    
    //Set selected student grade level name
    var idContainer = document.getElementById('student-id');
    idContainer.innerHTML = '';
    
}

    //For selection and changing color of selected counselor
    document.getElementById('counselor_list_item_container').addEventListener('click', function(e) {   // 1.
        var selected;
        if(e.target.tagName === 'LI') {                                      // 2.
            selected= document.querySelector('li.selected_counselor');                   // 2a.
            if(selected) selected.classList.remove('selected_counselor');                               // "
            e.target.classList.add('selected_counselor');                                    // 2b.
            // console.log("SELECTED COUNSELOR: " + e.target.innerHTML);
            // console.log("SELECTED COUNSELOR ID: " + e.target.id);

            // const counselorIndex = counselorList.findIndex(el => el.id === e.target.id);
            currentCounselor = counselorList.find(obj => {
                // console.log("Checking... " + obj.getNameLastFirst() + " id=" + obj.id);
                return obj.id == e.target.id;
            });

            console.log("SELECTED/CURRENT COUNSELOR: " + currentCounselor);

            filterStudentsUsingCurrentValues();
            // setFirstStudentAsCurrent();  //This is done in the filter method
            updateTotalsArea();
        }
    });
    //For selection and changing color of selected student
    document.getElementById('student_list_item_container').addEventListener('click', function(e) {   // 1.
        var selected;
        if(e.target.tagName === 'LI') {
            selected= document.querySelector('li.selected_student');
            // console.log("CURRENT STUDENT: " + e.target.innerHTML + " classes: " + selected.classList);
            if(selected) selected.classList.remove('selected_student');
            e.target.classList.add('selected_student');
            console.log("SELECTED STUDENT: " + e.target.innerHTML + " classes: " + e.target.classList);
            //Determine the selected student and get their object reference
            //Students list items are assigned an id of the student id... clever?
            const studentIndex = currentStudentList.findIndex(el => el.id === e.target.id);
            currentStudent = currentStudentList[studentIndex];
            
            // assignOptimalMultiCodeRequirementCourses(currentStudent, false);
            // console.log(currentStudent.getCompletedCourses().length);

            setCurrentStudentDataFields();
        }
    });

    //A function for defaulting to the first student in the student list (at startup and counselor selection change, etc.)
    //Uses the ul NOT the student list... seems safer that way
    function setFirstStudentAsCurrent() {
        var ul = document.getElementById("student_list_item_container");
        if(ul.firstChild) { //as long as there is at least one student
            //deselect current selected student
            selected= document.querySelector('li.selected_student');
            if(selected) selected.classList.remove('selected_student');
            //Highlight first student
            var studentUL = document.getElementById('student_list_item_container');
            var currentStudentLI = studentUL.getElementsByTagName('li')[0];
            currentStudentLI.classList.add('selected_student');

            //Determine the selected student and get their object reference
            //Students list items are assigned an id of the student id... clever?
            var selectedStudentID = currentStudentLI.id;
            const studentIndex = currentStudentList.findIndex(el => el.id === selectedStudentID);
            currentStudent = currentStudentList[studentIndex];
            
            setCurrentStudentDataFields();
        }
        else {
            clearStudentDataFields();
        }
    }

    //A function for defaulting to the first counselor in the counselor list (at startup, anywhere else?)
    //Uses the ul NOT the student list... seems safer that way
    function setFirstCounselorAsCurrent() {
        //deselect current selected counselor
        selected= document.querySelector('li.selected_counselor');
        if(selected) selected.classList.remove('selected_counselor');
        //Highlight first counselor
        var counselorUL = document.getElementById('counselor_list_item_container');
        var currentCounselorLI = counselorUL.getElementsByTagName('li')[0];
        currentCounselorLI.classList.add('selected_counselor');

        //Determine the selected counselor and get their object reference
        //Counselor list items are assigned an id of the counselor id... clever?
        var selectedCounselorID = currentCounselorLI.id;
        var counselorIndex = counselorList.findIndex(el => el.id === selectedCounselorID);
        if(counselorIndex = -1)
            currentCounselor = counselorList[0];
        else
            currentCounselor = counselorList[counselorIndex];
        // console.log("FIRST COUNSELOR IS " + selectedCounselorID + " " + currentCounselor + " index= " + counselorIndex);
    }

    //Selecting the proper data to display using student info dropdown selector
    var contentpanes = document.getElementsByClassName("content-pane");
    for(var i = 0; i < contentpanes.length; i++)
        contentpanes[i].style.display = "none";
    
    // Default is the Summary tab
    var summary = document.getElementById("summary-content");
    // var hist = document.getElementById("transcript-content");
    var dataselection = document.getElementById("dropdown-options");
    summary.style.display = "block";
    
    dataselection.addEventListener("change", function() {
        for(var i = 0; i < contentpanes.length; i++)
          contentpanes[i].style.display = "none";
    
    console.log("Selection: " + dataselection.options[dataselection.selectedIndex].value.toLowerCase());
    
    let currentId = dataselection.options[dataselection.selectedIndex].value.toLowerCase();
    currentId += "-content";
    var current_pane = document.getElementById(currentId);
    current_pane.style.display = "block";
});


function updateTotalsArea() {
    var elementWithTitle = document.getElementById("totals_title_school");
    if(currentCounselor.getLastName() === 'All Students')
        elementWithTitle.innerHTML = 'School Totals';
    else
        elementWithTitle.innerHTML = currentCounselor.getLastName() + ' Totals';

    var elementWithTotal = document.getElementById("total-students");
    elementWithTotal.innerHTML = currentStudentList.length;
    elementWithTotal = document.getElementById("total-freshmen");
    elementWithTotal.innerHTML = getCurrentTotalInGrade(9);
    elementWithTotal = document.getElementById("total-sophomores");
    elementWithTotal.innerHTML = getCurrentTotalInGrade(10);
    elementWithTotal = document.getElementById("total-juniors");
    elementWithTotal.innerHTML = getCurrentTotalInGrade(11);
    elementWithTotal = document.getElementById("total-seniors");
    elementWithTotal.innerHTML = getCurrentTotalInGrade(12);
    elementWithTotal = document.getElementById("total-warnings");
    elementWithTotal.innerHTML = getCurrentTotalStudentsWithWarnings();
    elementWithTotal = document.getElementById("total-overrides");
    elementWithTotal.innerHTML = getCurrentTotalStudentsWithOverrides();
}


// Selecting a row of a table of course objects
var selectedRow_courseTable = "";
var restoreColorCourse_font = "";

function highlight_course(row) {
    selectedRow_courseTable=row.cells[2].textContent;
    deHighlight_course();
    restoreColorCourse_font = row.style.color;
    row.style.backgroundColor = '#004aff';
    // row.style.backgroundColor = 'red';
    row.style.color = 'white';
    row.classList.toggle("selectedRow");
}

function deHighlight_course() { 
    var dataselection = document.getElementById("dropdown-options");
    let currentId = dataselection.options[dataselection.selectedIndex].value.toLowerCase();
    currentId += "-course_table";
    let courseTable = document.getElementById(currentId);
    let rows = courseTable.rows;
    for (let i = 0; i < rows.length; i++) {
        rows[i].style.backgroundColor = "transparent";
        if(rows[i].style.color === 'white')
            rows[i].style.color = restoreColorCourse_font;
    // rows[i].style.color = "black";
}
}

function selectedRow_courseTable() {
    alert(selectedRow_courseTable);
}

// Selecting a row of a table of Grad Requirements
var selectedRow_ReqTable = "";
var restoreColorGradReq_font = "";

function highlight_gradReq(row) {
    selectedRow_ReqTable=row.cells[2].textContent;
    deHighlight_gradReq();
    restoreColorGradReq_font = row.style.color;
    if(restoreColorGradReq_font === 'black')
        row.style.backgroundColor = '#3263eb'; //'#004aff';
    else
       row.style.backgroundColor = row.style.color;
    row.style.color = 'white';
    row.classList.toggle("selectedRow");
}

function deHighlight_gradReq() { 
    let gradTable = document.getElementById('gradreq_table');
    let rows = gradTable.rows;
    for (let i = 0; i < rows.length; i++) {
        rows[i].style.backgroundColor = 'transparent';
        if(rows[i].style.color === 'white')
            rows[i].style.color = restoreColorGradReq_font;
        // rows[i].style.color = "black";
    }   
}

function selectedRow_ReqTable() {
    alert(selectedRow_ReqTable);
}

//Sort table by header
function sortTable(sortCol, tableID, direction, isNumeric) {
    // console.log("SORTING...");
    var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
    table = document.getElementById(tableID);
    switching = true;
    // Set the sorting direction to ascending:
    dir = "asc";
    if(direction == -1)
        dir = "desc";
    /* Make a loop that will continue until
    no switching has been done: */
    while (switching) {
        // Start by saying: no switching is done:
        switching = false;
        rows = table.rows;
        /* Loop through all table rows (except the
        first, which contains table headers): */
        var startRow = 1;
        if(tableID === 'gradreq_table')
            startRow = 2; //leave credits on top of the requirement summary table
        for (i = startRow; i < (rows.length - 1); i++) {
            // Start by saying there should be no switching:
            shouldSwitch = false;
            /* Get the two elements you want to compare,
            one from current row and one from the next: */
            x = rows[i].getElementsByTagName("TD")[sortCol];
            y = rows[i + 1].getElementsByTagName("TD")[sortCol];
            /* Check if the two rows should switch place,
            based on the direction, asc or desc: */
            if (dir == "asc") {
                if(isNumeric && Number(x.innerHTML) > Number(y.innerHTML)
                    || (!isNumeric && x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase())) {
                    // If so, mark as a switch and break the loop:
                    shouldSwitch = true;
                    break;
                }
            } else if (dir == "desc") {
                if(isNumeric && Number(x.innerHTML) < Number(y.innerHTML)
                    || (!isNumeric && x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase())) {
                    // If so, mark as a switch and break the loop:
                    shouldSwitch = true;
                    break;
                }
            }
        }
        if (shouldSwitch) {
        /* If a switch has been marked, make the switch
        and mark that a switch has been done: */
        rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
        switching = true;
        // Each time a switch is done, increase this count by 1:
        switchcount ++;
        } else {
            /* If no switching has been done AND the direction is "asc",
            set the direction to "desc" and run the while loop again. */
            if (switchcount == 0 && dir == "asc") {
                dir = "desc";
                switching = true;
            }
        }
    }
    // console.log("Sorting complete.")
}

    var filterValue_currentGradeLevel = 0; //0 is for all years
    function setGradeLevelFilterValue(gradeLevel) {
        filterValue_currentGradeLevel = gradeLevel;
        filterStudentsUsingCurrentValues();
    }

    //Use the individual grade levels or 0 for all years
    function filterStudentsUsingCurrentValues() {
        currentStudentList = [];

        //Filter out students by counselor first
        if(currentCounselor.getLastName() === 'All Students') {
            currentStudentList = studentList;
        } else if(currentCounselor.getLastName() === 'Unassigned') {
            currentStudentList = studentList;
            for(var i = 0; i < counselorList.length; i++) {
                currentStudentList = currentStudentList.filter(obj => {
                    return obj.getCounselorName() !== counselorList[i].getNameLastFirst();
                });
            }
        }
        else {
            currentStudentList = studentList.filter(obj => {
                return obj.getCounselorName() === currentCounselor.getNameLastFirst();
            });
        }

        //Filter the counselor's students by grade level
        if(filterValue_currentGradeLevel != 0) {
            currentStudentList = currentStudentList.filter(obj => {
                return obj.gradeLevel == filterValue_currentGradeLevel;
            });
        }

        //check for students not assigned a grade level
        // for(var i=0; i < studentList.length; i++)
        //     if(studentList[i].gradeLevel != 9 && studentList[i].filterValue_currentGradeLevel != 10 && studentList[i].gradeLevel !=11 && studentList[i].gradeLevel != 12)
        //         console.log("i=" + i+ ": " + studentList[i].gradeLevel + " " + studentList[i].getNameLastFirst())
        console.log("Students in grade " + filterValue_currentGradeLevel + " = " + currentStudentList.length);
        
        //make GUI changes based on the filter result
        populateStudentLI();
        setFirstStudentAsCurrent();
        sortCurrentStudentList();
    }

    document.addEventListener('keydown', function(event){
        if(event.keyCode == 38 || event.keyCode == 40) {
            
            event.preventDefault(); //stop auto scroll with cursor
            var studentIndex = currentStudentList.findIndex(el => el === currentStudent);
            if(event.keyCode == 38)
                studentIndex--;
            else
                studentIndex++;
            //Watch for out of bounds
            if(studentIndex >= 0 && studentIndex <= currentStudentList.length-1) {
                selected= document.querySelector('li.selected_student');
                if(selected) selected.classList.remove('selected_student');
                var studentUL = document.getElementById('student_list_item_container');
                
                //Select and highlight next student
                var currentStudentLI = studentUL.getElementsByTagName('li')[studentIndex];
                currentStudentLI.classList.add('selected_student');
                
                //Determine the selected student and get their object reference
                //Students list items are assigned an id of the student id... clever?
                // var selectedStudentID = currentStudentLI.id;
                // const studentIndex = currentStudentList.findIndex(el => el.id === selectedStudentID);
                currentStudent = currentStudentList[studentIndex];
                
                //automate the scroll in the list
                var elDistanceToTop = window.pageYOffset + currentStudentLI.getBoundingClientRect().top;
                var elDistanceToBottom = window.pageYOffset + currentStudentLI.getBoundingClientRect().bottom;
                var ulTop = window.pageYOffset + studentUL.getBoundingClientRect().top;
                var ulBottom = window.pageYOffset + studentUL.getBoundingClientRect().bottom;

                var list = studentUL, targetLi = currentStudentLI; // id tag of the <li> element
                if(event.keyCode == 38 && elDistanceToTop < ulTop)
                    studentUL.scrollTop = (targetLi.offsetTop - Math.round(elDistanceToTop) - currentStudentLI.getBoundingClientRect().height);
                else if(event.keyCode == 40 && elDistanceToBottom > ulBottom) {
                    studentUL.scrollTop = (targetLi.offsetTop - Math.round(elDistanceToTop) + currentStudentLI.getBoundingClientRect().height);
                }
                console.log("ScrollTop= " + elDistanceToTop + ", ScrollBottom= " + elDistanceToBottom + ", UL top= " + ulTop + ", UL bottom= " + ulBottom);


                setCurrentStudentDataFields();
            }
        }
    });

    var currentSortValue = 'alpha'; //options: alpha, gradreqs, credits
    function setSortValue(value) {
        currentSortValue = value;
        sortCurrentStudentList();
    }

    function sortCurrentStudentList() {
        if(currentSortValue === 'alpha')
            currentStudentList.sort(compareUsingLastNameAlphabetical)
        else if(currentSortValue === 'gradreqs')
            currentStudentList.sort(compareUsingMissingRequirements)
        else if(currentSortValue === 'credits')
            currentStudentList.sort(compareUsingMissingCredits)

        populateStudentLI();
        setFirstStudentAsCurrent();
    }

    function compareUsingLastNameAlphabetical( a, b ) {
        if ( a.getLastName() < b.getLastName() ){
            return -1;
        }
        if ( a.getLastName() > b.getLastName() ){
            return 1;
        }
        return 0;
    }
    function compareUsingMissingRequirements( a, b ) {
        if( a.getTotalNumMissingRequirements() > b.getTotalNumMissingRequirements() ){
            return -1;
        }
        if( a.getTotalNumMissingRequirements() < b.getTotalNumMissingRequirements() ){
            return 1;
        }
        return 0;
    }
    function compareUsingMissingCredits( a, b ) {
        console.log(a.getCreditsNeeded() + ", " + b.getCreditsNeeded());
        if ( a.getCreditsNeeded() > b.getCreditsNeeded() ){
            return -1;
        }
        if ( a.getCreditsNeeded() < b.getCreditsNeeded() ){
            return 1;
        }
        console.log(a.getNameLastFirst() + ", " + b.getNameLastFirst());
        return compareUsingMissingRequirements( a, b );
    }

</script>
</html>
